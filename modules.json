{
    "firewall": [
        {
            "name": "Disable_File_Sharing",
            "desc": "Disable File and Printer Sharing.",
            "command": "netsh advfirewall firewall set rule group=\"File and Printer Sharing\" new enable=No",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Disable_RDP",
            "desc": "Disable Remote Desktop Protocol",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 1 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "RDP_Security_Maximizes",
            "desc": "Maximizes The Security Of A Remote Desktop Connection",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v MinEncryptionLevel /t REG_DWORD /d 4 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Enable_Firewall",
            "desc": "Enable Firewall All Profiles",
            "command": "netsh advfirewall set allprofiles state on",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Remove_Enable_LMhosts_Lookup",
            "desc": "Remove Enable LMhosts Lookup",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Services\\NetBT\\Parameters\\EnableLMHosts\" /v MinEncryptionLevel /t REG_DWORD /d 0 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Block_All_Ports",
            "desc": "Block All Incoming Connections",
            "command": "netsh advfirewall set allprofiles firewallpolicy blockinboundalways,allowoutbound",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Disable_ICMP_IPV4",
            "desc": "ICMP  is an error-reporting protocol network devices like routers use to generate error messages to the source IP address when network problems prevent delivery of IP packets",
            "command": "netsh advfirewall firewall add rule name='ICMP Allow incoming V4 echo request' protocol=icmpv4:8,any dir=in action=allow",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Disable_ICMP_IPV6",
            "desc": "ICMP  is an error-reporting protocol network devices like routers use to generate error messages to the source IP address when network problems prevent delivery of IP packets",
            "command": "netsh advfirewall firewall add rule name='ICMP Allow incoming V6 echo request' protocol=icmpv6:8,any dir=in action=allow",
            "require_superuser": "False",
            "target_os": "win"
        },
		{
            "name": "Disable_The_Sending_Of_Unencrypted_Passwords_To_Third-Party_SMB_Servers",
            "desc": "Some non-Microsoft SMB servers only support unencrypted (plain text) password authentication. Sending plain text passwords across the network, when authenticating to an SMB server, reduces the overall security of the environment.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Services\\NetBT\\Parameters\" /v EnablePlainTextPassword /t REG_DWORD /d 0 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Do_Not_Allow_Any_Shares_To_Be_Accessed_Anonymously",
            "desc": "Network shares that can be accessed anonymously will not be allowed",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\" /v NullSessionShares /t REG_SZ /d (Blank) /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Disable_Local_System_NULL_Session_Fallback",
            "desc": "NTLM sessions that are allowed to fall back to Null (unauthenticated) sessions may gain unauthorized access.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Control\\Lsa\\MSV1_0\" /v allownullsessionfallback /t REG_DWORD /d 0 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Set_the_LMA_Level_To_Allow_Only_NTLMv2_And_Refuse_LM_And_NTLM",
            "desc": "The Kerberos v5 authentication protocol is the default for authentication for domains. NTLM which is less secure, is retained in later Windows versions for compatibility with standalone systems as well as applications that may still use it. Earlier versions of the LM/NTLM protocol are particularly vulnerable to attack and must be prevented.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Control\\Lsa\" /v LmCompatibilityLevel /t REG_DWORD /d 5 /f",
            "require_superuser": "False",
            "target_os": "win"
        }
    ],
    "kernel": [
        {
            "name": "Logs_Restrict_Access",
            "desc": "Restricting access to kernel logs",
            "command": "echo \"kernel.dmesg_restrict = 1\" > /etc/sysctl.d/50-dmesg-restrict.conf",
            "require_superuser": "False",
            "target_os": "linux"
        },
        {
            "name": "Pointers_Restrict_Access",
            "desc": "Restricting access to kernel pointers.",
            "command": "echo \"kernel.kptr_restrict = 1\" > /etc/sysctl.d/50-kptr-restrict.conf",
            "require_superuser": "False",
            "target_os": "linux"
        }
    ],
    "general": [
        {
            "name": "Disable_The_Guest_Account",
            "desc": "Guest accounts allow temporary login on a Windows system without requiring to provide credentials/password. Each system administrator would have a different need on how to configure guest account on their systems. This post explains how to enable or disable guest account on a Windows computer.",
            "command": "net user guest /active:no",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Do_Not_Allow_Everyone_Permissions_To_Apply_To_Anonymous_Users",
            "desc": "This setting helps define the permissions that anonymous users have. If this setting is enabled then anonymous users have the same rights and permissions as the built-in Everyone group. Anonymous users should not have these permissions or rights.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Control\\Lsa\" /v EveryoneIncludesAnonymous /t REG_DWORD /d 0 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Do_Not_Allow_Anonymous_Enumeration_Of_SAM_Accounts_And_Shares",
            "desc": "This is a Category 1 finding because it allows anonymous logon users (null session connections) to list all account names and enumerate all shared resources, thus providing a map of potential points to attack the system.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\" /v NtfsDisableLastAccessUpdate  /t REG_DWORD /d 1 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "NTFS_Update_Disable",
            "desc": "If you'd like to get a little extra performance out of your disk volumes, or if you have a large number of folders, you can disable this process and make directory lists more nimble.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Control\\Lsa\" /v RestrictAnonymous  /t REG_DWORD /d 1 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Require_Ctrl_Alt_Del_For_Interactive_Logins",
            "desc": "Disabling the Ctrl+Alt+Del security attention sequence can compromise system security. Because only Windows responds to the Ctrl+Alt+Del security sequence, you can be assured that any passwords you enter following that sequence are sent only to Windows. If you eliminate the sequence requirement, malicious programs can request and receive your Windows password. Disabling this sequence also suppresses a custom logon banner.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableCAD  /t REG_DWORD /d 0 /f",
            "require_superuser": "False",
            "target_os": "win"
        },
        {
            "name": "Configure_A_Machine_Inactivity_For_15_minutes",
            "desc": "Unattended systems are susceptible to unauthorized use and should be locked when unattended. The screen saver should be set at a maximum of 15 minutes and be password protected. This protects critical and sensitive data from exposure to unauthorized personnel with physical access to the computer.",
            "command": "reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v InactivityTimeoutSecs  /t REG_DWORD /d 0x00000384 /f",
            "require_superuser": "False",
            "target_os": "win"
        }
    ]
}